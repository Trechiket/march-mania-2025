# Прогнозирование NCAA March Madness 2025

## Описание проекта
Решение для соревнования Kaggle [March Machine Learning Mania 2025](https://www.kaggle.com/competitions/march-machine-learning-mania-2025), 
получившее **0.11390 brier score** и занявшее 189 место из 1727 команд **(Top 11%)** в финальном лидерборде.  

Задача заключалась в прогнозировании результатов всех возможных матчей мужского и женского баскетбольных турниров NCAA 2025.

## Подход к решению

### Feature Engineering
Ключевым компонентом решения стало создание информативных признаков:

1. **Рейтинги команд**
   - Point Differential Rating - рейтинг на основе разницы очков с использованием Ridge регрессии
   - Offensive Efficiency (OE) Rating - эффективность атаки (очки на владение)
   - Defensive Efficiency (DE) Rating - эффективность защиты
   - Pace Rating - темп игры команды

2. **Статистика регулярного сезона**
   - Средние показатели по всем игровым метрикам (очки, броски, подборы и т.д.)
   - Статистика соперников для оценки силы расписания
   - Количество побед/поражений и процент побед

3. **Актуальная форма**
   - Процент побед за последние 14 дней регулярного сезона
   - Важный признак для учета текущего состояния команды

4. **Турнирные характеристики**
   - Посев команды в турнире (seed)
   - Massey Ordinals - агрегированные рейтинги от множества систем
   - Индикатор play-in игр

5. **Продвинутые предсказательные признаки**
   - Предсказанная эффективность атаки для турнирных игр (XGBoost)
   - Предсказанный темп игры
   - Все признаки рассчитываются как разности между командами

### Модели

**Мужской турнир**
- Модель: XGBoost Regressor для предсказания разницы очков
- Калибровка: Logistic Regression для преобразования в вероятности
- Валидация: Season-based CV (обучение на всех предыдущих сезонах)
- Отбор признаков: Кастомный Forward Feature Selection

**Женский турнир**
- Модель: Logistic Regression с MinMax масштабированием
- Отбор признаков: Кастомный Forward Feature Selection
- Прямое предсказание вероятности победы
- Более простая модель показала лучшие результаты для женского турнира

### 0/1 flip Стратегия
- Идея стратегии заключалась в использовании возможности предоставлять два финальных файла с предсказаниями.
После получения итогового файла с предсказаниями, среди матчей первого тура был найден матч,
в котором вероятность победы команды А над командой Б стремится к 0.5.  


- Суть стратегии - в одном файле поставить вероятность победы команды А над командой Б равной 1,
а в другом 0.  
Таким образом, мы гарантированно избавляемся от ошибки в (0.5 - 0)^2 = 0.25 brier score в данном матче.


## Использование
1. Скачайте данные с [страницы соревнования](https://www.kaggle.com/competitions/march-machine-learning-mania-2025/data)
2. Поместите данные в папку `data/`
3. Запустите ноутбук файл `main.py`
